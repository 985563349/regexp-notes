### 字符匹配

正则表达式是匹配模式，要么匹配字符，要么匹配位置。

#### 两种模糊匹配

如果正则只有精准匹配是没多大意义的，比如`/hello/`，只能匹配字符串中的**"hello"**这个子串。

```javascript
/hello/.test('hello'); // true
```

正则表达式之所以强大，是因为能实现模糊匹配。而模糊匹配，有两个方向上的模糊：**横向模糊**和**纵向模糊**。

#### 横向模糊匹配

横向模糊指的是，一个正则可匹配的字符串的长度是不固定的。

其实现方式是使用量词。譬如`{m, n}`，表示连续出现最少 m 次，最多 n 次。

```javascript
'abc abbc abbbc abbbbc abbbbbc abbbbbbc'.match(/ab{2,5}c/g); // ['abbc', 'abbbc', 'abbbbc', 'abbbbbc']
```

案例中使用的正则是`/ab{2,5}c/g`，其中`g`是正则的一个修饰符。表示全局匹配，即在目标字符串中按顺序找到满足匹配模式的所有子串，强调的是“所有”，而不只是“第一个”。`g`是单词**global**的首字母。

#### 纵向模糊匹配

纵向模糊指的是，一个正则匹配的字符串，具体到某一位字符时，它可以不是某个确定的字符，可以有多种可能。

其实现的方式是使用字符组。譬如`[abc]`，表示该字符可以是字符 a、b、c 中的任何一个。

```javascript
'a0b a1b a2b a3b a4b'.match(/a[123]b/g); // ['a1b', 'a2b', 'a3b']
```

#### 字符组

需强调的是，虽叫字符组（字符类），但只是**其中一个字符**。

##### 范围表示法

如果字符组里的字符特别多，可以使用范围表示法。比如`[123456abcdefGHIJKLM]`，可以写成`[1-9a-fG-M]`。用连字符`-`来省略和简写。

##### 排除字符组

纵向模糊匹配，还有一种情形就是，某位字符可以是任何东西，但就不能是某些字符。此时就是排除字符组（反义字符组）的概念。

例如`[^abc]`，表示一个除字符 a 、b、c 之外的任何一个字符。字符组的第一位放`^`脱字符，表示求反的概念。

##### 常见字符组简写形式

- \d：表示`[0-9]`。表示是一位数字。
- \D：表示`[^0-9]`。表示除数字外的任意字符。
- \w：表示`[0-9a-zA-Z_]`。表示数字、字母、下划线。
- \W：表示`[^0-9a-zA-Z]`。非单词字符。
- \s：表示`[\t\v\n\r\f]`。表示空白字符，包括空格、水平制表符、垂直制表符、换行符、回车符、换页符。
- \S：表示`[^\t\v\n\r\f]`。非空白字符。
- .：表示`[^\n\r\u2028\u2029]`。通配符，几乎表示任意字符。换行符、回车符、行分割符和段分割符除外。

如果要匹配任意字符，可以使用`[\d\D]`、`[\w\W]`、`[\s\S]`和`[^]`中任何的一个。

#### 量词

量词也称重复。掌握`{m,n}`的准确含义后，只需要记住一些简写形式。

##### 简写形式

- {m,}：表示至少出现 m 次。
- {m}：等价于`{m,m}`，表示出现 m 次。
- ?：等价于`{0,1}`，表示出现 0 或 1 次。
- +：等价于`{1,}`，表示出现至少一次。
- \*：等价于`{0,}`，表示出现任意次，有可能不出现。

##### 贪婪匹配与惰性匹配

示例：

```javascript
'123 1234 12345 123456'.match(/\d{2,5}/g); // ['123', '1234', '12345', '12345']
```

其中正则`/\d{2,5}/`，表示数字连续出现 2 到 5 次，会匹配 2 位、3 位、4 位、5 位连续数字。这种匹配是贪婪的，只要在范围内，它会尽可能多的匹配。

惰性匹配，就是尽可能少的匹配：

```javascript
'123 1234 12345 123456'.match(/\d{2,5}?/g); // => ['12', '12', '34', '12', '34', '12', '34', '56'];
```

其中正则`/\d{2,5}?/`表示，虽然 2 到 5 次都行，当 2 个就够的时候，就不再往下尝试了。

通过在量词后面添加`?`就能实现惰性匹配。

#### 分支选择

一个模式可以实现横向和纵向模糊匹配。而多选分支可以支持多个子模式任选其一。

具体形式如下：`p1|p2|p3`，其中 p1、p2、p3 是子模式，用`|`（管道符）分隔，表示其中任何之一。

例如，要匹配字符串**'good'**和**'nice'**可以使用`/good|nice/`：

```javascript
'good idea, nice try.'.match(/good|nice/g); // ['good', 'nice']
```

分支结构是惰性的。即当前面的匹配上了，后面的就不再尝试了：

```javascript
'goodbye'.match(/good|goodbye/g); // ['good']
```

把正则改写成`/goodbye|good/`，结果是：

```javascript
'goodbye'.match(/goodbye|good/g); // ['goodbye']
```
